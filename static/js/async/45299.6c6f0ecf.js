"use strict";(globalThis.webpackChunkfrontend=globalThis.webpackChunkfrontend||[]).push([["45299"],{72782(e,s,t){t.d(s,{A:()=>o});var a=t(74848),n=t(51851),i=t(7064),r=t(96540);let o=e=>((0,r.useEffect)(()=>{e.loadContentDispatch?.()},[]),(0,a.jsx)("div",{className:"ContentDisplay row center-xs",children:(0,a.jsx)("div",{className:`${e.fullWidth?"col-md-12":"col-md-10 col-xs-11"} contentdisplay-content-parent`,children:(0,a.jsx)(n.Z,{className:"contentdisplay-content",elevation:i.e.THREE,children:e.display})})}))},16916(e,s,t){t.d(s,{A:()=>l});var a=t(74848),n=t(96402),i=t(87497),r=t(39798),o=t(79642);let l=({options:e,selectedValue:s,onClick:t,buttonProps:l,popoverProps:d})=>{let c;return(0,a.jsx)(n.A,{...d,interactionKind:"click",content:(0,a.jsx)(i.W,{children:e.map(({value:e,label:s})=>(0,a.jsx)(r.D,{text:s,onClick:()=>{t?.(e)}},s))}),children:(0,a.jsx)(o.$,{...l,children:(c=e.find(({value:e})=>e===s),c?.label)})})}},15115(e,s,t){t.d(s,{G:()=>l});var a=t(74848),n=t(9584);t(96540);var i=t(29458);let r=({onClick:e})=>(0,a.jsx)(i.A,{label:"Return to Academy",icon:n.W.ARROW_RIGHT,onClick:e,options:{iconOnRight:!0}}),o=({onClick:e})=>(0,a.jsx)(i.A,{label:"Submit",icon:n.W.ARROW_RIGHT,onClick:e,options:{iconOnRight:!0}}),l=e=>e.questionProgress[0]===e.questionProgress[1]?e.submitOnFinish?(0,a.jsx)(o,{onClick:e.onClickSubmit}):(0,a.jsx)(r,{onClick:e.onClickReturn},"return_to_academy"):(0,a.jsx)(i.A,{label:"Next",icon:n.W.ARROW_RIGHT,onClick:e.onClickNext,options:{iconOnRight:!0}})},94361(e,s,t){t.d(s,{S:()=>r});var a=t(74848),n=t(9584);t(96540);var i=t(29458);let r=e=>e.questionProgress[0]<=1?null:(0,a.jsx)(i.A,{label:"Previous",icon:n.W.ARROW_LEFT,onClick:e.onClick})},40293(e,s,t){t.d(s,{Y:()=>i});var a=t(74848);t(96540);var n=t(29458);let i=({questionProgress:e})=>(0,a.jsx)(n.A,{label:`Question ${e[0]} of ${e[1]}  `,isDisabled:!0})},23129(e,s,t){t.d(s,{A:()=>y});var a=t(74848),n=t(79642),i=t(92473),r=t(68178),o=t(28761),l=t(76129),d=t(9584),c=t(96540),u=t(40503),m=t(29458),h=t(51851),p=t(7064),x=t(35537),g=t(46942),j=t.n(g);let v=({index:e,result:s})=>{let{t}=(0,u.Bd)("sideContent",{keyPrefix:"resultCard"});return(0,a.jsx)("div",{className:j()("ResultCard","pass"===s.resultType?"correct":"wrong"),"data-testid":"ResultCard",children:(0,a.jsxs)(h.Z,{elevation:p.e.ONE,children:[(0,a.jsxs)("div",{className:"result-data",children:[(0,a.jsx)("div",{className:"result-idx","data-testid":"result-idx",children:e+1}),(0,a.jsx)("div",{className:"result-status","data-testid":"result-status",children:s.resultType.toUpperCase()})]}),(0,a.jsx)(x.AC,{className:"result-expected","data-testid":"result-expected",children:s.expected}),(0,a.jsx)(x.AC,{className:"result-actual","data-testid":"result-actual",children:"error"===s.resultType?s.errors.map(e=>{switch(e.errorType){case"timeout":return t("timeout");case"syntax":return t("syntax",{line:e.line,errorExplanation:e.errorExplanation});case"runtime":return t("runtime",{line:e.line,errorExplanation:e.errorExplanation});case"systemError":return t("systemError",{errorMessage:e.errorMessage});default:return t("unknown",{errorType:e.errorType})}}).join("\n\n"):s.actual})]})})};var A=t(53991),b=t(57415),N=t(64936);t(51085);let C=e=>{let{index:s,testcase:t,handleTestcaseEval:n}=e,i=c.useMemo(()=>{let e=void 0!==t.result||t.errors,s=(0,N.stringify)(t.result)===t.answer;return{correct:e&&s,wrong:e&&!s,secret:"secret"===t.type||"opaque"===t.type}},[t]),r=c.useCallback(()=>{n(s)},[s,n]);return(0,a.jsx)("div",{className:j()("AutograderCard",i),"data-testid":"AutograderCard",children:(0,a.jsx)(h.Z,{className:A.INTERACTIVE,elevation:p.e.ONE,onClick:r,children:"opaque"===t.type&&"assessment"===e.workspaceLocation?(0,a.jsx)(x.AC,{className:"testcase-placeholder","data-testid":"testcase-placeholder",children:"Hidden testcase"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.AC,{className:"testcase-program",children:t.program}),(0,a.jsx)(x.AC,{className:"testcase-expected",children:t.answer}),(0,a.jsx)(x.AC,{className:"testcase-actual","data-testid":"testcase-actual",children:t.errors?(0,b.parseError)(t.errors):void 0!==t.result?(0,N.stringify)(t.result):"No Answer"})]})})})},w=(e,s)=>(0,a.jsxs)("div",{className:e,children:[s,(0,a.jsx)(o.I,{icon:d.W.CARET_DOWN})]}),y=e=>{let s,t,h,{t:p}=(0,u.Bd)("sideContent",{keyPrefix:"autograder"}),[x,g]=(0,c.useState)(!0),[j,A]=(0,c.useState)(!0),{testcases:b,autogradingResults:N,handleTestcaseEval:y,workspaceLocation:E}=e,T=(0,c.useMemo)(()=>(0,a.jsxs)("div",{className:"autograder-help-tooltip",children:[(0,a.jsx)("p",{children:p("tooltip.clickTestcase")}),(0,a.jsx)("p",{children:p("tooltip.executeAll")}),(0,a.jsx)("p",{children:p("tooltip.backgroundInfo")}),(0,a.jsx)("p",{children:p("tooltip.privateTestcases")})]}),[p]),f=(0,c.useMemo)(()=>(0,a.jsxs)("div",{className:"testcases-header","data-testid":"testcases-header",children:[w("header-fn",p("headers.testcase")),w("header-expected",p("headers.expected")),w("header-actual",p("headers.actual"))]}),[p]),R=(0,c.useMemo)(()=>(0,a.jsxs)("div",{className:"results-header","data-testid":"results-header",children:[(0,a.jsxs)("div",{className:"header-data",children:[w("header-sn",p("headers.sn")),w("header-status",p("headers.status"))]}),w("header-expected",p("headers.expected")),w("header-actual",p("headers.actual"))]}),[p]),k=(0,c.useMemo)(()=>b.length>0?(0,a.jsxs)("div",{className:"testcaseCards",children:[f,b.map((e,s)=>(0,a.jsx)(C,{index:s,testcase:e,handleTestcaseEval:y,workspaceLocation:E},s))]}):(0,a.jsx)("div",{className:"noResults","data-testid":"noResults",children:p("noTestcases")}),[b,f,p,y,E]),I=(0,c.useMemo)(()=>N.length>0?(0,a.jsxs)("div",{children:[R,N.map((e,s)=>(0,a.jsx)(v,{index:s,result:e},s))]}):(0,a.jsx)("div",{className:"noResults","data-testid":"noResults",children:p("noResults")}),[N,R,p]),S=(0,c.useCallback)(()=>{g(!x)},[x]),M=(0,c.useCallback)(()=>A(!j),[j]);return(0,a.jsxs)("div",{className:"Autograder",children:[(0,a.jsxs)(n.$,{className:"collapse-button",icon:x?d.W.CARET_DOWN:d.W.CARET_RIGHT,minimal:!0,onClick:S,children:[(0,a.jsx)("span",{children:p("testcases")}),(0,a.jsx)(i.m,{content:T,placement:r.$.LEFT,children:(0,a.jsx)(o.I,{icon:d.W.HELP})})]}),(0,a.jsx)(l.S,{isOpen:x,keepChildrenMounted:!0,children:k}),(s=p("results"),t=j,h=M,(0,a.jsx)(m.A,{label:s,icon:t?d.W.CARET_DOWN:d.W.CARET_RIGHT,onClick:h,options:{className:"collapse-button",minimal:!0}})),(0,a.jsx)(l.S,{isOpen:j,keepChildrenMounted:!0,children:I})]})}},68833(e,s,t){t.d(s,{A:()=>d});var a=t(74848),n=t(53991),i=t(79642),r=t(46942),o=t.n(r),l=t(96540);let d=l.memo(()=>{let e=(0,l.useRef)(null);return(0,l.useEffect)(()=>{window.ToneMatrix&&window.ToneMatrix.initialise_matrix(e.current)},[]),(0,a.jsxs)("div",{className:"sa-tone-matrix",children:[(0,a.jsx)("div",{className:"row",children:(0,a.jsxs)("div",{className:o()("controls","col-xs-12",n.DARK,n.BUTTON_GROUP),children:[(0,a.jsx)(i.$,{id:"clear-matrix",onClick:()=>{window.ToneMatrix.clear_matrix()},children:"Clear"}),(0,a.jsx)(i.$,{id:"randomise-matrix",onClick:()=>{window.ToneMatrix.randomise_matrix()},children:"Randomise"})]})}),(0,a.jsx)("div",{className:"row",children:(0,a.jsx)("div",{className:"col-xs-12",ref:e})})]})},()=>!0)},62317(e,s,t){t.d(s,{G3:()=>d,Hw:()=>c,if:()=>m,jW:()=>u,sC:()=>h});var a=t(74353),n=t.n(a),i=t(97375),r=t.n(i),o=t(6279),l=t.n(o);n().extend(r()),n().extend(l());let d=e=>{let s=n()(e),t=n()();return s.isBefore(t)},c=e=>n()(e).format("Do MMMM, HH:mm"),u=e=>n()(e).format("MMMM Do YYYY, HH:mm"),m=e=>n()(e).format("MMMM Do YYYY"),h=(e,s)=>{let t=n()(e).add(s,"hours"),a=t.format("Do MMMM, HH:mm"),i=t.fromNow();return`${a} (${i})`}},59941(e,s,t){t.r(s),t.d(s,{Component:()=>eu,default:()=>em});var a=t(74848),n=t(64907),i=t(35505),r=t(79642),o=t(54348),l=t(28761),d=t(9584),c=t(96540),u=t(94201),m=t(41344),h=t(46807),p=t(61499),x=t(19549),g=t(97505),j=t(31230),v=t(16916),A=t(12149),b=t(35905),N=t(70622),C=t(55930),w=t(72782),y=t(42921),E=t(76099),T=t(53991),f=t(46942),R=t.n(f),k=t(38786),I=t(6261),S=t(63283);t(51085);var M=t(90559),W=t(62120),P=t(15115),O=t(94361),q=t(40293),H=t(471),G=t(40276),D=t(29890),L=t(23129),_=t(68833),$=t(75780),B=t(16773),X=t(31365),U=t(35537),V=t(77555),F=t(45111),Y=t(5193),J=t(58365),K=t(29458),Q=t(90913),z=t(62317),Z=t(37852);let ee=e=>(0,a.jsxs)("div",{className:"grading-comment-selector-NyIfvp",children:[(0,a.jsx)(U.H5,{className:"grading-comment-selector-title-PSZPVb",children:"LLM Comment Suggestions:"}),e.isLoading?(0,a.jsx)(n.I,{icon:(0,a.jsx)(i.y,{})}):(0,a.jsxs)("div",{children:[" ",e.comments.length>0?e.comments.map((s,t)=>(0,a.jsx)("button",{className:"grading-comment-selector-item-TlzcRy",onClick:()=>{e.onSelect(s)},children:s},t)):(0,a.jsx)("span",{children:"No Comments Generated"})," "]})]}),es="grading-editor-button",et={header:[d.W.HEADER,"Header Styles"],bold:[d.W.BOLD,"Bold"],italic:[d.W.ITALIC,"Italic"],strikethrough:[d.W.STRIKETHROUGH,"Strikethrough"],link:[d.W.LINK,"Link"],quote:[d.W.CITATION,"Quote"],code:[d.W.CODE,"Monospaced"],image:[d.W.MEDIA,"Image"],"unordered-list":[d.W.UNGROUP_OBJECTS,"Bullets"],"ordered-list":[d.W.NUMBERED_LIST,"Numbering"],"checked-list":[d.W.SQUARE,"Checkboxes"]},ea=e=>{let s=(0,u.wA)(),t=(0,A.c)(),{handleGradingSave:n,handleGradingSaveAndContinue:i,handleReautogradeAnswer:m}=(0,c.useMemo)(()=>({handleGradingSave:(...e)=>s(h.A.submitGrading(...e)),handleGradingSaveAndContinue:(...e)=>s(h.A.submitGradingAndContinue(...e)),handleReautogradeAnswer:(...e)=>s(h.A.reautogradeAnswer(...e))}),[s]),[p,x]=(0,c.useState)(e.xpAdjustment.toString()),[g,v]=(0,c.useState)(e.comments),[b,N]=(0,c.useState)("write"),[C,w]=(0,c.useState)(!1);(0,c.useEffect)(()=>{q()},[e.submissionId,e.questionId]);let E=async()=>await (0,j.ar)(t,e.answer_id),T=async s=>await (0,j.VO)(t,e.answer_id,s),[f,R]=(0,c.useState)([]),[k,I]=(0,c.useState)([]),[M,W]=(0,c.useState)(!1),[P,O]=(0,c.useState)(!1),q=()=>{x(e.xpAdjustment.toString()),v(e.comments),N("write"),w(!1),R(e.ai_comments||[])},H=s=>async()=>{let t=(0,y.hM)(p||void 0)||void 0,a=e.initialXp+(t||0);(await T(g),a<0||a>e.maxXp)?(0,Z.JB)(`XP ${a.toString()} is out of bounds. Maximum xp is ${e.maxXp.toString()}.`):s(e.submissionId,e.questionId,t,g)},G=async()=>{await (0,S.cu)({contents:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Reautograde this answer?"}),(0,a.jsx)("p",{children:"Note: manual adjustments will be reset to 0."})]}),positiveLabel:"Reautograde",positiveIntent:"danger"})&&m(e.submissionId,e.questionId)},L=()=>{let s=(0,y.hM)(p||void 0);return e.xpAdjustment!==s||e.comments!==g},_=L(),$=void 0===e.gradedAt,B={intent:_||$?X.J.WARNING:X.J.NONE,minimal:!_&&!$,className:es},ea={intent:_?X.J.DANGER:X.J.NONE,minimal:!_,className:es},en={intent:_||$?X.J.SUCCESS:X.J.NONE,minimal:!_&&!$,className:es},ei=e.initialXp+((0,y.hM)(p||void 0)||0),er=`${e.initialXp>0?"-":""}${e.initialXp} to ${e.maxXp-e.initialXp}`;return(0,a.jsxs)("div",{className:"GradingEditor",children:[(0,a.jsx)(Q.X,{when:!C&&_,message:"You have unsaved changes. Are you sure you want to leave?"}),(0,a.jsx)("div",{className:"grading-editor-header",children:(0,a.jsxs)(U.H3,{children:["Currently Grading:",(0,a.jsx)("br",{}),e.studentNames.map((s,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{children:[s," (",e.studentUsernames[t],")"]}),(0,a.jsx)("br",{})]},t))]})}),null!==e.solution?(0,a.jsx)("div",{className:"grading-editor-marking-scheme",children:(0,a.jsxs)(U.AC,{children:[e.solution.toString()," "]})}):null,(0,a.jsx)("div",{className:"grading-editor-container",children:(0,a.jsxs)("div",{className:"grading-editor-xp",children:[(0,a.jsxs)("div",{className:"autograder-xp",children:[(0,a.jsx)("div",{children:"Autograder XP:"}),(0,a.jsxs)("div",{children:[`${e.initialXp} / ${e.maxXp}`," ",(0,a.jsx)(r.$,{icon:"refresh",small:!0,minimal:!0,onClick:G})]})]}),(0,a.jsxs)("div",{className:"xp-adjustment",children:[(0,a.jsx)("div",{children:"XP adjustment:"}),(0,a.jsx)("div",{children:(0,a.jsx)(V.O,{className:"adjustment-input",onValueChange:(e,s)=>{x(s)},value:p||"",buttonPosition:o.yX.RIGHT,fill:!0,placeholder:er,intent:ei<0||ei>e.maxXp?X.J.DANGER:X.J.NONE,min:0-e.initialXp,max:e.maxXp>e.initialXp?e.maxXp-e.initialXp:void 0,stepSize:50,minorStepSize:25,majorStepSize:100})})]}),(0,a.jsxs)("div",{className:"final-xp",children:[(0,a.jsx)("div",{children:"Final XP:"}),(0,a.jsx)("div",{children:`${ei} / ${e.maxXp}`})]})]})}),e.is_llm&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F.l,{title:"Full Composed LLM Prompt",icon:d.W.WRENCH,isOpen:P,onClose:()=>O(!1),children:(0,a.jsxs)("div",{className:"llm-prompt-dialog",children:[(0,a.jsxs)("div",{className:"forenote-section",children:[(0,a.jsxs)("span",{className:"forenote",children:[(0,a.jsx)("b",{children:"Note:"})," The titles here are provided merely to distinguish the different sections. They are not included in the final prompt."]}),(0,a.jsx)(r.$,{onClick:()=>{navigator.clipboard.writeText(e.prompts.map(e=>`**${e.role} Prompt**

${e.content}`).join("\n\n")),(0,Z.uT)("Composed prompt copied to clipboard!",2e3)},children:(0,a.jsx)(l.I,{icon:d.W.Clipboard})})]}),e.prompts.map(e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(U.H3,{children:[e.role," Level Prompt"]}),(0,a.jsx)(Y.c,{}),e.content]}))]})}),(0,a.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,a.jsx)(ee,{onSelect:e=>{k.includes(e)||I([e,...k]),v(g+e)},isLoading:M,comments:f}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"center"},children:[(0,a.jsx)(r.$,{style:{marginRight:"1rem"},onClick:async()=>{O(!0)},children:"View Prompt"}),(0,a.jsx)(r.$,{intent:"primary",onClick:async()=>{W(!0);let e=await E();W(!1),R(e?e.comments:[])},children:"Generate Comments"})]})]})]}),(0,a.jsx)("div",{className:"react-mde-parent",children:(0,a.jsx)(J.default,{value:g,onChange:v,selectedTab:b,onTabChange:e=>N(e),generateMarkdownPreview:e=>Promise.resolve((0,a.jsx)(D.A,{content:e,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,openLinksInNewWindow:!0})),minEditorHeight:200,maxEditorHeight:1e3,minPreviewHeight:240,getIcon:function(e){let s=(e=>{switch(e){case"header":case"bold":case"italic":case"strikethrough":case"link":case"quote":case"code":case"image":case"unordered-list":case"ordered-list":case"checked-list":{let[s,t]=et[e];return{iconName:s,title:t}}default:return{iconName:d.W.HELP}}})(e);return(0,a.jsx)(l.I,{icon:s.iconName,htmlTitle:s.title})}})}),"write"===b&&(0,a.jsxs)("div",{className:"grading-editor-draft-buttons",children:[(0,a.jsx)("div",{className:"grading-editor-save-button",children:(0,a.jsx)(K.A,{label:"Save Changes",icon:d.W.FLOPPY_DISK,onClick:H(n),options:B})}),(0,a.jsx)("div",{className:"grading-editor-discard-button",children:(0,a.jsx)(K.A,{label:"Discard Changes",icon:d.W.TRASH,onClick:()=>{(!L()||window.confirm("This will reset the editor. Are you sure?"))&&(x(e.xpAdjustment.toString()),v(e.comments),(0,Z.uT)("Discarded!",1e3))},options:ea})})]}),(0,a.jsx)("div",{className:"grading-editor-save-continue-button",children:(0,a.jsx)(K.A,{label:"Save and Continue",icon:d.W.UPDATED,onClick:H((e,s,t,a)=>{w(!0),i(e,s,t,a)}),options:en})}),e.graderName&&e.gradedAt&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Y.c,{}),(0,a.jsxs)("div",{className:"grading-editor-last-graded-details",children:["Last edited by ",(0,a.jsx)("b",{children:e.graderName})," on ",(0,z.Hw)(e.gradedAt)]})]})]})},en="grading",ei=`// This answer does not have significant changes from the given solution
// template and has thus been flagged as unanswered.
// If you think this is wrong, please ignore and grade accordingly.


`,er=e=>{var s,t;let r,o,l,x,g,j,v,N,C=(0,m.Zp)(),{selectedTab:w,setSelectedTab:y}=(0,$.k9)(en,"grading"),E=(0,A.N4)(s=>s.session.gradings[e.submissionId]),f=(0,A.N4)(e=>e.session.courseId),X=(0,A.N4)(e=>e.session.enableLlmGrading),{autogradingResults:U,isFolderModeEnabled:V,activeEditorTabIndex:F,editorTabs:Y,editorTestcases:J,isRunning:K,output:Q,replValue:z,currentSubmission:Z,currentQuestion:ee}=(0,A.N4)(e=>e.workspaces[en]),es=(0,u.wA)(),{handleBrowseHistoryDown:et,handleBrowseHistoryUp:er,handleClearContext:eo,handleDeclarationNavigate:el,handleEditorEval:ed,handleSetActiveEditorTabIndex:ec,handleRemoveEditorTabByIndex:eu,handleEditorValueChange:em,handleEditorUpdateBreakpoints:eh,handleGradingFetch:ep,handleReplEval:ex,handleReplOutputClear:eg,handleReplValueChange:ej,handleResetWorkspace:ev,handleChangeExecTime:eA,handleSideContentHeightChange:eb,handleTestcaseEval:eN,handleRunAllTestcases:eC,handleUpdateCurrentSubmissionId:ew,handleUpdateHasUnsavedChanges:ey,handlePromptAutocomplete:eE}=(0,c.useMemo)(()=>({handleBrowseHistoryDown:()=>es(b.A.browseReplHistoryDown(en)),handleBrowseHistoryUp:()=>es(b.A.browseReplHistoryUp(en)),handleClearContext:(e,s)=>es(b.A.beginClearContext(en,e,s)),handleDeclarationNavigate:e=>es(b.A.navigateToDeclaration(en,e)),handleEditorEval:()=>es(b.A.evalEditor(en)),handleSetActiveEditorTabIndex:e=>es(b.A.updateActiveEditorTabIndex(en,e)),handleRemoveEditorTabByIndex:e=>es(b.A.removeEditorTab(en,e)),handleEditorValueChange:(e,s)=>es(b.A.updateEditorValue(en,0,s)),handleEditorUpdateBreakpoints:(e,s)=>es(b.A.setEditorBreakpoint(en,e,s)),handleGradingFetch:e=>es(h.A.fetchGrading(e)),handleReplEval:()=>es(b.A.evalRepl(en)),handleReplOutputClear:()=>es(b.A.clearReplOutput(en)),handleReplValueChange:e=>es(b.A.updateReplValue(e,en)),handleResetWorkspace:e=>es(b.A.resetWorkspace(en,e)),handleChangeExecTime:e=>es(b.A.changeExecTime(e,en)),handleSideContentHeightChange:e=>es((0,I.k1)(e,en)),handleTestcaseEval:e=>es(b.A.evalTestcase(en,e)),handleRunAllTestcases:()=>es(b.A.runAllTestcases(en)),handleUpdateCurrentSubmissionId:(e,s)=>es(b.A.updateCurrentSubmissionId(e,s)),handleUpdateHasUnsavedChanges:e=>es(b.A.updateHasUnsavedChanges(en,e)),handlePromptAutocomplete:(e,s,t)=>es(b.A.promptAutocomplete(en,e,s,t))}),[es]);(0,c.useEffect)(()=>{if(ep(e.submissionId),!E)return;let s=e.questionId;e.questionId>=E.answers.length&&(s=E.answers.length-1);let t=E.answers[s].question,a="";"programming"===t.type&&(t.answer?t.answer.trim()===t.solutionTemplate.trim()?(a=ei+t.answer,(0,S.ug)({contents:"Question has not been answered."})):a=t.answer:a=t.solutionTemplate||""),em(0,a)},[]),(0,c.useEffect)(()=>{if(void 0===E)return;let s=e.questionId;void 0===E.answers[s]?C(`/courses/${f}/grading`):eT(e)});let eT=e=>{let s=e.submissionId,t=e.questionId;if(Z===s&&ee===t)return;let a=E.answers[t].question,n=[],i="",r="",o="",l=[];"programming"===a.type&&(n=a.autogradingResults,r=a.prepend,o=a.postpend,l=a.testcases,(i=a.answer)||(i=a.solutionTemplate),i.trim()===a.solutionTemplate?.trim()&&((0,S.ug)({contents:"Question has not been answered."}),i=ei+i)),eh(0,[]),ew(s,t),ev({autogradingResults:n,editorTabs:[{value:i,highlightedLines:[],breakpoints:[]}],programPrependValue:r,programPostpendValue:o,editorTestcases:l}),eA(a.library.execTimeMs??p.Kn.grading.execTime),eo(a.library,!0),ey(!1),i&&em(0,i)},ef=()=>{ed(),"autograder"===w&&eC()};if(void 0===E)return(0,a.jsx)(n.I,{className:R()("WorkspaceParent",T.DARK),description:"Getting assessment ready...",icon:(0,a.jsx)(i.y,{size:i.H.LARGE})});let eR=e.questionId>=E.answers.length?E.answers.length-1:e.questionId,ek=E.answers[eR].question,eI={controlBarProps:(o=(r=`/courses/${f}/grading`)+`/${e.submissionId}`,l=[eR+1,E.answers.length],x=(0,a.jsx)(P.G,{onClickNext:()=>C(o+`/${(eR+1).toString()}`),onClickReturn:()=>C(r),questionProgress:l},"next_question"),g=(0,a.jsx)(O.S,{onClick:()=>C(o+`/${(eR-1).toString()}`),questionProgress:l},"previous_question"),j=(0,a.jsx)(q.Y,{questionProgress:l},"question_view"),{editorButtons:[(0,a.jsx)(H.w,{isEntrypointFileDefined:null!==F,handleEditorEval:ef},"run")],flowButtons:[g,j,x]}),editorContainerProps:"programming"===ek.type||"voting"===ek.type?{editorVariant:"normal",isFolderModeEnabled:V,activeEditorTabIndex:F,setActiveEditorTabIndex:ec,removeEditorTabByIndex:eu,editorTabs:Y.map(G.U),editorSessionId:"",sessionDetails:null,handleDeclarationNavigate:el,handleEditorEval:ef,handleEditorValueChange:em,handleEditorUpdateBreakpoints:eh,handlePromptAutocomplete:eE,isEditorAutorun:!1,sourceChapter:ek?.library?.chapter||k.Chapter.SOURCE_4,sourceVariant:ek?.library?.variant??k.Variant.DEFAULT,externalLibraryName:ek?.library?.external?.name||"NONE"}:void 0,handleSideContentHeightChange:eb,mcqProps:{mcq:ek,handleMCQSubmit:e=>{}},sideBarProps:{tabs:[]},sideContentProps:(v=[{label:`Grading: Question ${eR+1}`,iconName:d.W.TICK,body:(0,a.jsx)(ea,{answer_id:E.answers[eR].id,ai_comments:E.answers[eR].ai_comments||[],solution:E.answers[eR].question.solution,questionId:E.answers[eR].question.id,prompts:E.answers[eR].prompts,submissionId:e.submissionId,initialXp:E.answers[eR].grade.xp,xpAdjustment:E.answers[eR].grade.xpAdjustment,maxXp:E.answers[eR].question.maxXp,studentNames:(s=E.answers[eR].student.name,t=E.answers[eR].team,s?[s]:null!=t?t.map(e=>e.name):[""]),studentAnswer:"programming"===E.answers[eR].question.type?E.answers[eR].question.answer:"N/A",studentUsernames:E.answers[eR].student.username?[E.answers[eR].student.username]:E.answers[eR].team.map(e=>e.username),is_llm:!!X&&"programming"==E.answers[eR].question.type,comments:E.answers[eR].grade.comments??"",graderName:E.answers[eR].grade.grader?E.answers[eR].grade.grader.name:void 0,autoGradingStatus:E.answers[eR].autoGradingStatus||"N/A",autoGradingResults:E.answers[eR].autogradingResults,gradedAt:E.answers[eR].grade.gradedAt?E.answers[eR].grade.gradedAt:void 0}),id:"grading"},{label:`Question ${eR+1}`,iconName:d.W.NINJA,body:(0,a.jsx)(D.A,{content:E.answers[eR].question.content}),id:"question_overview"},{label:"Autograder",iconName:d.W.AIRPLANE,body:(0,a.jsx)(L.A,{testcases:J,autogradingResults:U,handleTestcaseEval:eN,workspaceLocation:"grading"}),id:"autograder"},{label:"Briefing",iconName:d.W.BRIEFCASE,body:(0,a.jsx)(D.A,{content:E?E.assessment.summaryLong:"Briefing Unavailable. Try refreshing the page."}),id:"briefing"}],E.answers[eR].question.library.external.symbols.includes("get_matrix")&&v.push({label:"Tone Matrix",iconName:d.W.GRID_VIEW,body:(0,a.jsx)(_.A,{}),id:"tone_matrix"}),{onChange:(e,s,t)=>{e!==s&&y(e)},tabs:{beforeDynamicTabs:v,afterDynamicTabs:[]},workspaceLocation:en}),replProps:{handleBrowseHistoryDown:et,handleBrowseHistoryUp:er,handleReplEval:ex,handleReplValueChange:ej,output:Q,replValue:z,sourceChapter:ek?.library?.chapter||k.Chapter.SOURCE_4,sourceVariant:ek?.library?.variant??k.Variant.DEFAULT,externalLibrary:ek?.library?.external?.name||"NONE",replButtons:(N=(0,a.jsx)(M.g,{handleReplOutputClear:eg},"clear_repl"),[(0,a.jsx)(W.T,{handleReplEval:ex,isRunning:K},"eval_repl"),N])}};return(0,a.jsx)("div",{className:R()("WorkspaceParent",T.DARK),children:(0,a.jsx)(B.A,{...eI})})},eo=[{value:!0,label:"my groups"},{value:!1,label:"all groups"}],el=[{value:!1,label:"unpublished"},{value:!0,label:"all"}],ed=[{value:10,label:"10"},{value:15,label:"15"},{value:25,label:"25"},{value:50,label:"50"}],ec=()=>{let{courseId:e,gradingOverviews:s,role:t,group:T}=(0,A.wV)(),f=(0,m.g)(),R=t===p.Xh.Admin,[k,I]=(0,c.useState)(!R&&null!==T),[S,M]=(0,c.useState)(10),[W,P]=(0,c.useState)(!1),[O,q]=(0,c.useState)({page:1,filterParams:{}}),[H,G]=(0,c.useState)(!1),[D,L]=(0,c.useState)(!1),[_,$]=(0,c.useState)([]),B=(0,u.wA)(),X=(0,A.N4)(e=>e.workspaces.grading.allColsSortStates),U=(0,A.N4)(e=>e.workspaces.grading.hasLoadedBefore),V=(0,A.N4)(e=>e.workspaces.grading.requestCounter),F=(0,A.N4)(e=>e.session.accessToken),Y=(0,A.N4)(e=>e.session.refreshToken),J=(0,c.useMemo)(()=>V>0,[V]),K=(0,c.useCallback)((e,s)=>{q({page:e,filterParams:s}),B(b.A.setGradingHasLoadedBefore()),B(b.A.increaseRequestCounter()),B(h.A.fetchGradingOverviews(k,(0,C.lu)(W),(0,C.MY)(e,S),s,X))},[B,k,W,S,X]);if((0,c.useEffect)(()=>{H&&(B(b.A.increaseRequestCounter()),B(h.A.fetchGradingOverviews(k,(0,C.lu)(W),(0,C.MY)(O.page,S),O.filterParams,X)),G(!1))},[B,k,W,S,X,H,O]),(0,c.useEffect)(()=>{$(s?.data?.map(e=>e.studentName?e:{...e,studentName:Array.isArray(e.studentNames)?e.studentNames.join(", "):e.studentNames})??[]),B(b.A.decreaseRequestCounter())},[s,B]),f.submissionId&&!f.submissionId?.match(N.F0)||f.questionId&&!f.questionId?.match(N.F0))return(0,a.jsx)(m.C5,{to:`/courses/${e}/grading`});let Q=(0,y.hM)(f.submissionId),z=(0,y.hM)(f.questionId)||0;if(null!==Q)return(0,a.jsx)(er,{questionId:z,submissionId:Q});let Z=(0,a.jsx)(n.I,{className:"Grading",description:"Fetching submissions...",icon:(0,a.jsx)(i.y,{size:i.H.LARGE})});return(0,a.jsx)(w.A,{loadContentDispatch:()=>{U||B(h.A.fetchGradingOverviews(k))},display:s?.data===void 0?Z:(0,a.jsxs)("div",{className:"grading-table-wrapper",children:[(0,a.jsx)(x.A,{justifyContent:"space-between",children:(0,a.jsxs)(x.A,{justifyContent:"flex-start",style:{columnGap:"1.5rem"},children:[(0,a.jsx)(g.A,{style:{fontSize:"1.125rem",opacity:.9},children:"Submissions"}),(0,a.jsx)(r.$,{minimal:!0,icon:d.W.EXPORT,onClick:()=>{(0,j.UW)({accessToken:F,refreshToken:Y}).then(e=>(0,C.lL)(e?.data))},className:"export-csv-btn",children:"Export to CSV"})]})}),(0,a.jsxs)(x.A,{justifyContent:"flex-start",style:{columnGap:"0.5rem",marginTop:"0.5rem"},children:[(0,a.jsx)(g.A,{children:"Viewing"}),(0,a.jsx)(v.A,{options:el,selectedValue:W,onClick:P,popoverProps:{position:o.yX.BOTTOM},buttonProps:{minimal:!0,rightIcon:"caret-down"}}),(0,a.jsx)(g.A,{children:"submissions from"}),(0,a.jsx)(v.A,{options:eo,selectedValue:k,onClick:I,popoverProps:{position:o.yX.BOTTOM},buttonProps:{minimal:!0,rightIcon:"caret-down"}}),(0,a.jsx)(g.A,{children:"showing"}),(0,a.jsx)(v.A,{options:ed,selectedValue:S,onClick:M,popoverProps:{position:o.yX.BOTTOM},buttonProps:{minimal:!0,rightIcon:"caret-down"}}),(0,a.jsx)(g.A,{children:"entries per page."}),(0,a.jsx)(r.$,{className:D?"grading-refresh-loop":"",minimal:!0,style:{padding:0},onClick:e=>{G(!0),L(!0)},onAnimationEnd:e=>L(!1),disabled:J,children:(0,a.jsx)(l.I,{htmlTitle:"Refresh",icon:d.W.REFRESH})})]}),(0,a.jsx)(E.Ay,{showAllSubmissions:W,totalRows:s.count,pageSize:S,submissions:_,updateEntries:K})]}),fullWidth:!0})},eu=ec;eu.displayName="Grading";let em=ec}}]);
//# sourceMappingURL=45299.6c6f0ecf.js.map