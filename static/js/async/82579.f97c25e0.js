"use strict";(globalThis.webpackChunkfrontend=globalThis.webpackChunkfrontend||[]).push([["82579"],{12951:function(e,s,a){a.d(s,{A:()=>i});var r=a(74848),l=a(51851),n=a(7064),t=a(96540);let i=e=>((0,t.useEffect)(()=>{e.loadContentDispatch?.()},[]),(0,r.jsx)("div",{className:"ContentDisplay row center-xs",children:(0,r.jsx)("div",{className:`${e.fullWidth?"col-md-12":"col-md-10 col-xs-11"} contentdisplay-content-parent`,children:(0,r.jsx)(l.Z,{className:"contentdisplay-content",elevation:n.e.THREE,children:e.display})})}))},42846:function(e,s,a){a.r(s),a.d(s,{default:()=>ed,Component:()=>eo});var r=a(74848),l=a(35537),n=a(11903),t=a(10720),i=a(5193),o=a(79642),d=a(31365),c=a(96540),u=a(83509),h=a(64088),m=a(31465),p=a(60921),x=a(39572),g=a(12951),f=a(53991),b=a(81168),j=a(54348),C=a(28761),v=a(19551),N=a(12316),y=a(40249),A=a(66314),S=a(97426),R=a(22083),D=a(2543),w=a(48422),k=a(81720),U=a(15145);let I=[{headerName:"Name",field:"name"},{headerName:"Username",field:"username"},{headerName:"Role",field:"role"}],P={flex:1,filter:!0,resizable:!0,sortable:!0},T=e=>{let[s,a]=c.useState([]),[n,t]=c.useState(""),{CSVReader:i}=(0,w.pb)(),u=(0,r.jsx)("div",{className:"Grid",children:(0,r.jsx)(R.W6,{theme:S.N8R,domLayout:"autoHeight",columnDefs:I,defaultColDef:P,rowData:s,rowHeight:36,suppressCellFocus:!0,suppressMovableColumns:!0,pagination:!0})}),h=[...U.A.authProviders.entries()].map(([e,s])=>e),[m,p]=c.useState(h[0]);return(0,r.jsxs)("div",{className:"add-users",children:[(0,r.jsx)(l.H2,{children:"Add Stories Users"}),u,(0,r.jsx)(l.H4,{children:"Upload a CSV file to mass insert or update users in your course."}),(0,r.jsx)("div",{className:"upload-container",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"upload-settings",children:[(0,r.jsx)("div",{className:"file-input",children:(0,r.jsx)(i,{onUploadAccepted:e=>(e=>{let{data:l,errors:n}=e;if(n.length)return void t("Error detected while uploading the CSV file! Please recheck the file and try again.");let i=[...s];if(l.length+s.length>1e3)return void t("Please limit each upload to 1000 entries!");for(let e=0;e<l.length;e++){if(3!==l[e].length)return void t((0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:["Invalid format (line ",e,")! Please ensure that the name, username and role is specified for each row entry!"]}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{children:["Format: ",(0,r.jsx)("i",{children:"name,username,role"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{children:"(please hover over the question mark above for more details)"})]}));if(!Object.values(k.gO).includes(l[e][2]))return void t(`Invalid role (line ${e})! Please ensure that the third column of each entry contains one of the following: 'member, moderator, admin'`)}(l.forEach(e=>{i.push({name:e[0],username:e[1],role:e[2]})}),(0,D.uniqBy)(i,e=>e.username).length!==i.length)?t("There are duplicate usernames in the uploaded CSV(s)!"):(a(i),t(""))})(e),config:{delimiter:",",skipEmptyLines:!0},children:({getRootProps:e,acceptedFile:s,ProgressBar:a,getRemoveFileProps:l})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{className:f.FILE_INPUT,...e(),children:[(0,r.jsx)("div",{style:{minWidth:250},children:" "}),(0,r.jsx)("span",{className:f.FILE_UPLOAD_INPUT,children:"Upload CSV"})]}),(0,r.jsx)(b.A,{content:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("u",{children:"CSV Format"}),": \xa0",(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"name,username,role"})})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"name"})}),": the name of the user"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"username"})}),": username of the user in the corresponding authentication"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"role"})}),": the role of the user ",(0,r.jsx)("i",{children:"(member | moderator | admin)"})]}),(0,r.jsx)("p",{children:"\xa0"}),(0,r.jsx)("p",{children:(0,r.jsx)("u",{children:"Examples:"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(Luminus): \xa0 Wei Kai,e1234567,member"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(Google): \xa0 Timothy,learner@gmail.com,moderator"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(GitHub): \xa0 Mingkai,ghusername,admin"})})]}),interactionKind:"hover",position:j.yX.TOP,popoverClassName:"file-input-popover",children:(0,r.jsx)(C.I,{icon:A.W.HELP,className:"file-input-icon"})})]})})}),(0,r.jsx)(v.g,{className:"html-select",label:(0,r.jsxs)("div",{className:"html-select-label",children:[(0,r.jsx)("div",{children:"Authentication Provider"}),(0,r.jsx)(b.A,{content:"The authentication provider your learners will use to log in with",interactionKind:"hover-target",position:j.yX.TOP,popoverClassName:"html-select-popover",children:(0,r.jsx)(C.I,{icon:A.W.HELP,className:"html-select-label-icon"})})]}),inline:!0,children:(0,r.jsx)(N.g,{options:h,value:m,onChange:e=>p(e.target.value)})})]}),n&&(0,r.jsx)(y.P,{intent:d.J.DANGER,title:"Invalid CSV file provided!",children:n})]})}),(0,r.jsx)(o.$,{className:"add-button",text:"Add Stories Users",intent:0===s.length?d.J.NONE:d.J.WARNING,onClick:()=>{e.handleAddNewUsersToCourse(s,m),a([]),p(h[0])}})]})},E=[{headerName:"Username",field:"username"},{headerName:"Role",field:"role"},{headerName:"Group",field:"group"}],G={flex:1,filter:!0,resizable:!0,sortable:!0},O=e=>{let[s,a]=c.useState([]),[n,t]=c.useState(""),{CSVReader:i}=(0,w.pb)(),u=(0,r.jsx)("div",{className:"Grid",children:(0,r.jsx)(R.W6,{theme:S.N8R,domLayout:"autoHeight",columnDefs:E,defaultColDef:G,rowData:s,rowHeight:36,suppressCellFocus:!0,suppressMovableColumns:!0,pagination:!0})}),h=[...U.A.authProviders.entries()].map(([e,s])=>e),[m,p]=c.useState(h[0]);return(0,r.jsxs)("div",{className:"add-users",children:[(0,r.jsx)(l.H2,{children:"Add Users"}),u,(0,r.jsx)(l.H4,{children:"Upload a CSV file to mass insert or update users in your course."}),(0,r.jsx)("div",{className:"upload-container",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"upload-settings",children:[(0,r.jsx)("div",{className:"file-input",children:(0,r.jsx)(i,{onUploadAccepted:e=>(e=>{let{data:l,errors:n}=e;if(n.length)return void t("Error detected while uploading the CSV file! Please recheck the file and try again.");let i=[...s];if(l.length+s.length>1e3)return void t("Please limit each upload to 1000 entries!");for(let e=0;e<l.length;e++){if(2!==l[e].length&&3!==l[e].length)return void t((0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:["Invalid format (line ",e,")! Please ensure that the username and role is specified for each row entry!"]}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{children:["Format: ",(0,r.jsx)("i",{children:"username,role"})," ",(0,r.jsx)("b",{children:"OR"})," ",(0,r.jsx)("i",{children:"username,role,group"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{children:"(please hover over the question mark above for more details)"})]}));if(!Object.values(k.Xh).includes(l[e][1]))return void t(`Invalid role (line ${e})! Please ensure that the second column of each entry contains one of the following: 'admin, staff, student'`)}(l.forEach(e=>{i.push({username:e[0],role:e[1],group:e[2]})}),(0,D.uniqBy)(i,e=>e.username).length!==i.length)?t("There are duplicate usernames in the uploaded CSV(s)!"):(a(i),t(""))})(e),config:{delimiter:",",skipEmptyLines:!0},children:({getRootProps:e,acceptedFile:s,ProgressBar:a,getRemoveFileProps:l})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{className:f.FILE_INPUT,...e(),children:[(0,r.jsx)("div",{style:{minWidth:250},children:" "}),(0,r.jsx)("span",{className:f.FILE_UPLOAD_INPUT,children:"Upload CSV"})]}),(0,r.jsx)(b.A,{content:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("u",{children:"CSV Format"}),": \xa0",(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"username,role"})}),"\xa0\xa0OR\xa0\xa0",(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"username,role,group"})})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"username"})}),": the username of the learner in the corresponding authentication provider"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"role"})}),": the role of the learner in this course"," ",(0,r.jsx)("i",{children:"(admin | staff | student)"})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:(0,r.jsx)("i",{children:"group (optional)"})}),": the group name that the learner belongs to in this course"]}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(*Note that staff or admin will automatically be assigned as group leader and each group"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"can only have one leader. If there are duplicates the latest entry will take effect)"})}),(0,r.jsx)("p",{children:"\xa0"}),(0,r.jsx)("p",{children:(0,r.jsx)("u",{children:"Examples:"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(Luminus): \xa0e1234567,student \xa0•\xa0 e1234567,student,Group1"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(Google): \xa0learner@gmail.com,staff \xa0•\xa0 learner@gmail.com,staff,Group1"})}),(0,r.jsx)("p",{children:(0,r.jsx)("i",{children:"(GitHub): \xa0ghusername,admin \xa0•\xa0 ghusername,admin,Group1"})})]}),interactionKind:"hover",position:j.yX.TOP,popoverClassName:"file-input-popover",children:(0,r.jsx)(C.I,{icon:A.W.HELP,className:"file-input-icon"})})]})})}),(0,r.jsx)(v.g,{className:"html-select",label:(0,r.jsxs)("div",{className:"html-select-label",children:[(0,r.jsx)("div",{children:"Authentication Provider"}),(0,r.jsx)(b.A,{content:"The authentication provider your learners will use to log in with",interactionKind:"hover-target",position:j.yX.TOP,popoverClassName:"html-select-popover",children:(0,r.jsx)(C.I,{icon:A.W.HELP,className:"html-select-label-icon"})})]}),inline:!0,children:(0,r.jsx)(N.g,{options:h,value:m,onChange:e=>p(e.target.value)})})]}),n&&(0,r.jsx)(y.P,{intent:d.J.DANGER,title:"Invalid CSV file provided!",children:n})]})}),(0,r.jsx)(o.$,{className:"add-button",text:"Add Users",intent:0===s.length?d.J.NONE:d.J.WARNING,onClick:()=>{e.handleAddNewUsersToCourse(s,m),a([]),p(h[0])}})]})};var H=a(41397),L=a(11678);let W=e=>{let{data:s}=e,{rowIndex:a}=e.node,l=s[e.field],n=c.useCallback(()=>{e.setStateHandler(a,!l)},[e,a,l]);return(0,r.jsx)(L.dO,{checked:l,onChange:n})};var F=a(45111),V=a(31643),M=a(5960),X=a(64313);let J=({data:e,node:s,deleteRowHandler:a})=>{let{rowIndex:l}=s,[n,t]=(0,c.useState)(!1),i=(0,c.useCallback)(()=>{a(l),t(!1)},[a,l]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.$,{icon:A.W.CROSS,onClick:()=>{t(!0)}}),(0,r.jsxs)(F.l,{icon:A.W.WARNING_SIGN,isOpen:n,onClose:()=>t(!1),title:"Warning",children:[(0,r.jsxs)(V.R,{children:[(0,r.jsxs)("p",{children:["Are you sure you want to ",(0,r.jsx)("b",{children:"delete"})," the assessment type ",(0,r.jsx)("i",{children:e.type}),"?"]}),(0,r.jsx)("p",{children:(0,r.jsx)("b",{children:"All related assessments, submissions and answers will be deleted as well upon clicking the main save button."})})]}),(0,r.jsx)(M.E,{actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.A,{label:"Cancel",icon:A.W.CROSS,onClick:()=>t(!1),options:{minimal:!1}}),(0,r.jsx)(X.A,{label:"Ok",icon:A.W.TICK,onClick:i,options:{minimal:!1,intent:d.J.WARNING}})]})})]})]})};var $=a(67849);let B=e=>{let{data:s}=e,{rowIndex:a}=e.node,l=c.useCallback(s=>{e.setStateHandler(a,s)},[e,a]);return(0,r.jsx)($.O,{value:s[e.field],min:0,clampValueOnBlur:!0,onValueChange:l})},K={assessmentConfigId:-1,type:"untitled",isManuallyGraded:!0,isGradingAutoPublished:!1,displayInDashboard:!0,isMinigame:!1,hoursBeforeEarlyXpDecay:0,hasTokenCounter:!1,hasVotingFeatures:!1,earlySubmissionXp:0},_={flex:3,minWidth:70,filter:!1,resizable:!0,sortable:!1},z=(0,c.forwardRef)(({setHasChangesAssessmentConfig:e,initialConfigs:s},a)=>{let n=c.useRef(),t=(0,c.useRef)((0,D.cloneDeep)(s)),[i,d]=(0,c.useState)(s);(0,c.useEffect)(()=>{e(!(0,D.isEqual)(i,s))},[i,s,e]),(0,c.useImperativeHandle)(a,()=>({getData:()=>i,resetData:()=>{d(s),t.current=(0,D.cloneDeep)(s)}}));let u=(0,c.useCallback)((e,s)=>{d(a=>{let r=(0,D.cloneDeep)(a)??[];return r[e].isManuallyGraded=s,s&&(r[e].isGradingAutoPublished=!1,n.current?.getDisplayedRowAtIndex(e)?.setDataValue("isGradingAutoPublished",!1)),n.current?.getDisplayedRowAtIndex(e)?.setDataValue("isManuallyGraded",s),r})},[]),h=(0,c.useCallback)((e,s)=>{d(a=>{let r=(0,D.cloneDeep)(a)??[];return r[e].isGradingAutoPublished=s,s&&(r[e].isManuallyGraded=!1,n.current?.getDisplayedRowAtIndex(e)?.setDataValue("isManuallyGraded",!1)),n.current?.getDisplayedRowAtIndex(e)?.setDataValue("isGradingAutoPublished",s),r})},[]),m=(0,c.useCallback)(e=>(s,a)=>{d(r=>{let l=(0,D.cloneDeep)(r)??[];return l[s][e]=a,n.current?.getDisplayedRowAtIndex(s)?.setDataValue(e,a),l})},[]),p=(0,c.useCallback)(m("displayInDashboard"),[]),x=(0,c.useCallback)(m("isMinigame"),[]),g=(0,c.useCallback)(m("hasTokenCounter"),[]),f=(0,c.useCallback)(m("hasVotingFeatures"),[]),b=(0,c.useCallback)(m("earlySubmissionXp"),[]),j=(0,c.useCallback)(m("hoursBeforeEarlyXpDecay"),[]),C=(0,c.useCallback)(()=>{i.length>=8?(0,H.JB)("You can have at most 8 assessment types!"):(d(e=>[...e,{...K}]),n.current?.applyTransaction({add:[{...K}]}))},[i.length]),v=(0,c.useCallback)(e=>{if(i.length<=1)return void(0,H.JB)("You must have at least 1 assessment type!");d(s=>{let a=(0,D.cloneDeep)(s)??[];return a.splice(e,1),a});let s=n.current?.getDisplayedRowAtIndex(e)?.data;n.current?.applyTransaction({remove:[s]})},[i.length]),N=(0,c.useMemo)(()=>[{headerName:"Assessment Type",field:"type",rowDrag:!0,editable:!0},{headerName:"Is Manually Graded",field:"isManuallyGraded",cellRenderer:W,cellRendererParams:{setStateHandler:u,field:"isManuallyGraded"}},{headerName:"Is Auto-published",field:"isGradingAutoPublished",cellRenderer:W,cellRendererParams:{setStateHandler:h,field:"isGradingAutoPublished"}},{headerName:"Display in Dashboard",field:"displayInDashboard",cellRenderer:W,cellRendererParams:{setStateHandler:p,field:"displayInDashboard"}},{headerName:"Is Minigame",field:"isMinigame",cellRenderer:W,cellRendererParams:{setStateHandler:x,field:"isMinigame"}},{headerName:"Voting Features*",field:"hasVotingFeatures",cellRenderer:W,cellRendererParams:{setStateHandler:f,field:"hasVotingFeatures"}},{headerName:"Token Counter*",field:"hasTokenCounter",cellRenderer:W,cellRendererParams:{setStateHandler:g,field:"hasTokenCounter"}},{headerName:"Max Bonus XP",field:"earlySubmissionXp",cellRenderer:B,cellRendererParams:{setStateHandler:b,field:"earlySubmissionXp"}},{headerName:"Early Hours Before Decay",field:"hoursBeforeEarlyXpDecay",cellRenderer:B,cellRendererParams:{setStateHandler:j,field:"hoursBeforeEarlyXpDecay"}},{headerName:"Delete",field:"placeholderToPreventColumnRerender",cellRenderer:J,cellRendererParams:{deleteRowHandler:v},resizable:!1,flex:2}],[v,p,x,b,g,f,j,h,u,x]),y=(0,c.useCallback)(e=>{let s=e.node,a=e.overNode;if(s!==a){var r,l,n;let e,t=s.data,o=a?.data,c=Y(i,t),u=Y(i,o),h=[...i];r=h,l=c,n=u,e=r[l],r.splice(l,1),r.splice(n,0,e),d(h)}},[i]),A=e=>{n.current?.setGridOption("rowData",i)},w=(0,r.jsxs)("div",{className:"Grid",children:[(0,r.jsx)(R.W6,{theme:S.N8R,domLayout:"autoHeight",columnDefs:N,defaultColDef:_,onGridReady:e=>{n.current=e.api},rowData:t.current,rowHeight:36,rowDragManaged:!0,suppressCellFocus:!0,suppressMovableColumns:!0,suppressPaginationPanel:!0,onRowDragMove:y,onRowDragLeave:A,onRowDragEnd:A,onCellValueChanged:e=>{"type"===e.colDef.field&&d(s=>{let a=(0,D.cloneDeep)(s)??[];return a[e.rowIndex].type=e.value,a})}}),(0,r.jsxs)("div",{className:"footer-text",children:["*If you create an assessment with these toggles enabled, they will be activated within the assessment ",(0,r.jsx)("b",{children:"by default"}),". However, you can also visit ground control to manually override these settings if needed."]})]});return(0,r.jsxs)("div",{className:"assessment-configuration",children:[(0,r.jsxs)("div",{className:"assessment-configuration-header-container",children:[(0,r.jsx)(l.H2,{children:"Assessment Configuration"}),(0,r.jsx)(o.$,{text:"Add Row",onClick:C,className:"add-row-button"})]}),w]})});function Y(e,s){for(let a=0;a<e.length;a++)if((0,D.isEqual)(e[a],s))return a;return -1}var q=a(43157);let Q=e=>{let{data:s}=e,a=c.useCallback(a=>{e.handleUpdateStoriesUserRole(s.id,a.target.value)},[s,e]),l=[{label:"User",value:k.gO.Standard},{label:"Moderator",value:k.gO.Moderator},{label:"Admin",value:k.gO.Admin}];return(0,r.jsx)(b.A,{content:"You cannot downgrade yourself from an admin role!",interactionKind:"click",position:j.yX.TOP,disabled:e.id!==s.id,children:(0,r.jsx)(N.g,{options:l,onChange:a,fill:!0,minimal:!0,style:{textAlign:"center"},value:s.role,disabled:e.id===s.id})})},Z=({data:e,handleDeleteStoriesUserFromUserGroup:s})=>{let[a,l]=(0,c.useState)(!1),n=(0,c.useCallback)(()=>{s(e.id),l(!1)},[e.id,s]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.A,{content:"You cannot delete an admin!",interactionKind:"click",position:j.yX.TOP,disabled:e.role!==k.gO.Admin,children:(0,r.jsx)(o.$,{text:"Delete User",icon:A.W.CROSS,onClick:()=>{e.role===k.gO.Admin?(0,H.JB)("You cannot delete an admin user!"):l(!0)},disabled:e.role===k.gO.Admin})}),(0,r.jsxs)(F.l,{icon:A.W.WARNING_SIGN,isOpen:a,onClose:()=>l(!1),title:"Deleting Stories User",canOutsideClickClose:!0,children:[(0,r.jsx)(V.R,{children:(0,r.jsxs)("p",{children:["Are you sure you want to ",(0,r.jsx)("b",{children:"delete"})," the user"," ",(0,r.jsxs)("i",{children:[e.name," (",e.username,")"]}),"?"]})}),(0,r.jsx)(M.E,{actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.A,{label:"Cancel",icon:A.W.CROSS,onClick:()=>l(!1),options:{minimal:!1}}),(0,r.jsx)(X.A,{label:"Confirm",icon:A.W.TRASH,onClick:n,options:{minimal:!1,intent:d.J.DANGER}})]})})]})]})},ee={flex:1,filter:!0,resizable:!0,sortable:!0},es=e=>{let s=c.useRef(),a=e.storiesUsers?.map(e=>e.name?e:{...e,name:"(user has yet to log in)"}),n=[{headerName:"Name",field:"name",sort:"asc"},{headerName:"Username",field:"username"},{headerName:"Role",field:"role",cellRenderer:Q,cellRendererParams:{id:e.userId,handleUpdateStoriesUserRole:e.handleUpdateStoriesUserRole}},{headerName:"Actions",field:"actions",cellRenderer:Z,cellRendererParams:{handleDeleteStoriesUserFromUserGroup:e.handleDeleteStoriesUserFromUserGroup},filter:!1,resizable:!1}],t=(0,r.jsx)("div",{className:"Grid",children:(0,r.jsx)(R.W6,{theme:S.N8R,domLayout:"autoHeight",columnDefs:n,defaultColDef:ee,onGridReady:e=>{s.current=e.api},rowData:a,rowHeight:36,suppressCellFocus:!0,suppressMovableColumns:!0,pagination:!0})});return(0,r.jsxs)("div",{className:"users-configuration",children:[(0,r.jsxs)("div",{className:"users-header-container",children:[(0,r.jsx)(l.H2,{children:"Stories Users"}),(0,r.jsx)(o.$,{text:"Export as CSV",className:"export-csv-button",onClick:()=>{s.current&&s.current.exportDataAsCsv({fileName:`SA Stories Users (${new Date().toISOString()}).csv`,columnKeys:["name","username","role"]})}})]}),t]})},ea=e=>{let{data:s}=e,a=c.useCallback(a=>{e.handleUpdateUserRole(s.courseRegId,a.target.value)},[s,e]),l=[{label:"Student",value:k.Xh.Student},{label:"Staff",value:k.Xh.Staff},{label:"Admin",value:k.Xh.Admin}];return(0,r.jsx)(b.A,{content:"You cannot downgrade yourself from an admin role!",interactionKind:"click",position:j.yX.TOP,disabled:e.courseRegId!==s.courseRegId,children:(0,r.jsx)(N.g,{options:l,onChange:a,fill:!0,minimal:!0,style:{textAlign:"center"},value:s.role,disabled:e.courseRegId===s.courseRegId})})},er=({data:e,handleDeleteUserFromCourse:s})=>{let[a,l]=(0,c.useState)(!1),n=(0,c.useCallback)(()=>{s(e.courseRegId),l(!1)},[e.courseRegId,s]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.A,{content:"You cannot delete an admin!",interactionKind:"click",position:j.yX.TOP,disabled:e.role!==k.Xh.Admin,children:(0,r.jsx)(o.$,{text:"Delete User",icon:A.W.CROSS,onClick:()=>{e.role===k.Xh.Admin?(0,H.JB)("You cannot delete an admin user!"):l(!0)},disabled:e.role===k.Xh.Admin})}),(0,r.jsxs)(F.l,{icon:A.W.WARNING_SIGN,isOpen:a,onClose:()=>l(!1),title:"Deleting User From Course",canOutsideClickClose:!0,children:[(0,r.jsxs)(V.R,{children:[(0,r.jsxs)("p",{children:["Are you sure you want to ",(0,r.jsx)("b",{children:"delete"})," the user"," ",(0,r.jsxs)("i",{children:[e.name," (",e.username,")"]}),"?"]}),(0,r.jsx)("p",{children:(0,r.jsx)("b",{children:"All their assessment answers will be deleted as well."})})]}),(0,r.jsx)(M.E,{actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.A,{label:"Cancel",icon:A.W.CROSS,onClick:()=>l(!1),options:{minimal:!1}}),(0,r.jsx)(X.A,{label:"Confirm",icon:A.W.TRASH,onClick:n,options:{minimal:!1,intent:d.J.DANGER}})]})})]})]})},el={flex:1,filter:!0,resizable:!0,sortable:!0},en=e=>{let s=c.useRef(),a=e.userCourseRegistrations?.map(e=>e.name?e:{...e,name:"(user has yet to log in)"}),n=[{headerName:"Name",field:"name",sort:"asc"},{headerName:"Username",field:"username"},{headerName:"Group",field:"group"},{headerName:"Role",field:"role",cellRenderer:ea,cellRendererParams:{courseRegId:e.courseRegId,handleUpdateUserRole:e.handleUpdateUserRole}},{headerName:"Actions",field:"actions",cellRenderer:er,cellRendererParams:{handleDeleteUserFromCourse:e.handleDeleteUserFromCourse},filter:!1,resizable:!1}],t=(0,r.jsx)("div",{className:"Grid",children:(0,r.jsx)(R.W6,{theme:S.N8R,domLayout:"autoHeight",columnDefs:n,defaultColDef:el,onGridReady:e=>{s.current=e.api},rowData:a,rowHeight:36,suppressCellFocus:!0,suppressMovableColumns:!0,pagination:!0})});return(0,r.jsxs)("div",{className:"users-configuration",children:[(0,r.jsxs)("div",{className:"users-header-container",children:[(0,r.jsx)(l.H2,{children:"Users"}),(0,r.jsx)(o.$,{text:"Export as CSV",className:"export-csv-button",onClick:()=>{s.current&&s.current.exportDataAsCsv({fileName:`SA Users (${new Date().toISOString()}).csv`,columnKeys:["name","username","group","role"]})}})]}),t]})},et={courseName:"",courseShortName:"",viewable:!0,enableGame:!0,enableAchievements:!0,enableOverallLeaderboard:!0,enableContestLeaderboard:!0,topLeaderboardDisplay:100,topContestLeaderboardDisplay:10,enableSourcecast:!0,enableStories:!1,moduleHelpText:""},ei=()=>{let[e,s]=(0,c.useState)(!1),[a,f]=(0,c.useState)(!1),[b,j]=(0,c.useState)(et),C=(0,u.wA)(),v=(0,h.wV)(),N=(0,h.N4)(e=>e.stories);(0,c.useEffect)(()=>{C(x.A.fetchCourseConfig()),C(x.A.fetchAssessmentConfigs()),C(x.A.fetchAdminPanelCourseRegistrations())},[C]),(0,c.useEffect)(()=>{v.enableStories&&C(p.A.fetchAdminPanelStoriesUsers())},[C,v.enableStories]),(0,c.useEffect)(()=>{j({courseName:v.courseName,courseShortName:v.courseShortName,viewable:v.viewable,enableGame:v.enableGame,enableAchievements:v.enableAchievements,enableOverallLeaderboard:v.enableOverallLeaderboard,enableContestLeaderboard:v.enableContestLeaderboard,topLeaderboardDisplay:v.topLeaderboardDisplay,topContestLeaderboardDisplay:v.topContestLeaderboardDisplay,enableSourcecast:v.enableSourcecast,enableStories:v.enableStories,moduleHelpText:v.moduleHelpText})},[v.courseName,v.courseShortName,v.enableAchievements,v.enableOverallLeaderboard,v.enableContestLeaderboard,v.topLeaderboardDisplay,v.topContestLeaderboardDisplay,v.enableGame,v.enableSourcecast,v.enableStories,v.moduleHelpText,v.viewable]);let y=(0,c.useRef)(null);(0,c.useEffect)(()=>{y.current?.resetData()},[v.assessmentConfigurations]);let A={userId:N.userId,storiesUsers:N.storiesUsers,handleUpdateStoriesUserRole:(e,s)=>C(x.A.updateStoriesUserRole(e,s)),handleDeleteStoriesUserFromUserGroup:e=>C(x.A.deleteStoriesUserUserGroups(e))},S=(0,c.useCallback)(()=>{e&&(C(x.A.updateCourseConfig(b)),s(!1));let r=y.current?.getData()??[],l=v.assessmentConfigurations??[],n=new Set(r.map(e=>e.assessmentConfigId));l.filter(e=>!n.has(e.assessmentConfigId)).forEach(e=>C(x.A.deleteAssessmentConfig(e))),a&&(C(x.A.updateAssessmentConfigs(r)),f(!1))},[b,C,a,e,v.assessmentConfigurations]),R=(0,r.jsxs)("div",{className:"admin-panel",children:[(0,r.jsx)(l.H1,{children:"Admin Panel"}),(0,r.jsxs)(n.t,{id:"admin-panel",renderActiveTabPanelOnly:!0,children:[(0,r.jsx)(t.o,{id:"configuration",title:"Configuration",panel:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.A,{courseConfiguration:b,setCourseConfiguration:e=>{j(e),s(!0)}}),(0,r.jsx)(i.c,{}),(0,r.jsx)(z,{ref:y,initialConfigs:v.assessmentConfigurations??[],setHasChangesAssessmentConfig:f}),(0,r.jsx)(o.$,{text:"Save",disabled:!e&&!a,style:{marginTop:"15px"},intent:e||a?d.J.WARNING:d.J.NONE,onClick:S})]})}),(0,r.jsx)(t.o,{id:"users",title:"Users",panel:(0,r.jsx)(en,{courseRegId:v.courseRegId,userCourseRegistrations:v.userCourseRegistrations,handleUpdateUserRole:(e,s)=>C(x.A.updateUserRole(e,s)),handleDeleteUserFromCourse:e=>C(x.A.deleteUserCourseRegistration(e))})}),(0,r.jsx)(t.o,{id:"stories-users",title:"Stories Users",panel:(0,r.jsx)(es,{...A})}),(0,r.jsx)(t.o,{id:"add-users",title:"Add Users",panel:(0,r.jsx)(O,{handleAddNewUsersToCourse:(e,s)=>C(m.A.addNewUsersToCourse(e,s))})}),(0,r.jsx)(t.o,{id:"add-stories-users",title:"Add Stories Users",panel:(0,r.jsx)(T,{handleAddNewUsersToCourse:(e,s)=>C(m.A.addNewStoriesUsersToCourse(e,s))})})]})]});return(0,r.jsx)(g.A,{display:R,fullWidth:!1})},eo=ei;eo.displayName="AdminPanel";let ed=ei},43157:function(e,s,a){a.d(s,{A:()=>x});var r=a(74848),l=a(51138),n=a(35537),t=a(19551),i=a(58270),o=a(11903),d=a(10720),c=a(5193),u=a(11678),h=a(96540),m=a(64088),p=a(48299);let x=e=>{let{isMobileBreakpoint:s}=(0,m.Qs)(),[a,x]=h.useState("WRITE"),{courseName:g,courseShortName:f,viewable:b,enableGame:j,enableAchievements:C,enableOverallLeaderboard:v,enableContestLeaderboard:N,topLeaderboardDisplay:y,topContestLeaderboardDisplay:A,enableSourcecast:S,enableStories:R,moduleHelpText:D}=e.courseConfiguration,w=(0,r.jsx)(l.f,{id:"moduleHelpText",className:"input-textarea",fill:!0,value:D||"",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,moduleHelpText:s.target.value})}),k=(0,r.jsx)("div",{className:"input-markdown",children:(0,r.jsx)(p.A,{content:D||"",openLinksInNewWindow:!0})}),U=h.useCallback((e,s,a)=>{e!==s&&x(e)},[x]);return(0,r.jsxs)("div",{className:"course-configuration",children:[(0,r.jsx)(n.H2,{children:g}),(0,r.jsx)(n.H3,{children:f}),(0,r.jsxs)("div",{className:"inputs",children:[(0,r.jsxs)("div",{className:"text",children:[(0,r.jsx)(t.g,{helperText:"Please enter the course name that will be used for course selection.",inline:!0,label:"Course Name",labelFor:"courseName",children:(0,r.jsx)(i.M,{id:"courseName",defaultValue:g,onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,courseName:s.target.value})})}),(0,r.jsx)(t.g,{helperText:"Please enter the course short name. This will be displayed on the top left.",inline:!0,label:"Course Short Name",labelFor:"courseShortName",children:(0,r.jsx)(i.M,{id:"courseShortName",defaultValue:f,onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,courseShortName:s.target.value})})}),(0,r.jsxs)(t.g,{helperText:"Please enter the module help text that will be used in the course help dialog.",inline:!0,label:"Module Help Text",labelFor:"moduleHelpText",children:[(0,r.jsxs)(o.t,{selectedTabId:a,onChange:U,className:"module-help-text-tabs",children:[(0,r.jsx)(d.o,{id:"WRITE",title:"Write"}),(0,r.jsx)(d.o,{id:"PREVIEW",title:"Preview"})]}),"WRITE"===a&&w,"PREVIEW"===a&&k]}),(0,r.jsx)(t.g,{helperText:"Enter the Top XX students to be displayed on the Overall Leaderboard",inline:!0,label:"Top Leaderboard Display",labelFor:"topLeaderboardDisplay",children:(0,r.jsx)(i.M,{id:"topLeaderboardDisplay",value:String(y),onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,topLeaderboardDisplay:Number(s.target.value)})})}),(0,r.jsx)(t.g,{helperText:"Enter the Top XX students to be displayed on the Contest Leaderboard",inline:!0,label:"Top Contest Leaderboard Display",labelFor:"topContestLeaderboardDisplay",children:(0,r.jsx)(i.M,{id:"topContestLeaderboardDisplay",value:String(A),onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,topContestLeaderboardDisplay:Number(s.target.value)})})})]}),!s&&(0,r.jsx)(c.c,{}),(0,r.jsxs)("div",{className:"booleans",children:[(0,r.jsx)(u.dO,{checked:b,label:"Viewable",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,viewable:s.target.checked})}),(0,r.jsx)(u.dO,{checked:j,label:"Enable Game",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,enableGame:s.target.checked})}),(0,r.jsx)(u.dO,{checked:C,label:"Enable Achievements",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,enableAchievements:s.target.checked})}),(0,r.jsx)(u.dO,{checked:S,label:"Enable Sourcecast",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,enableSourcecast:s.target.checked})}),(0,r.jsx)(u.dO,{checked:R,label:"Enable Stories",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,enableStories:s.target.checked})}),(0,r.jsx)(u.dO,{checked:v,label:"Enable Overall Leaderboard",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,enableOverallLeaderboard:s.target.checked})}),(0,r.jsx)(u.dO,{checked:N,label:"Enable Contest Leaderboard",onChange:s=>e.setCourseConfiguration({...e.courseConfiguration,enableContestLeaderboard:s.target.checked})})]})]})]})}}}]);
//# sourceMappingURL=82579.f97c25e0.js.map