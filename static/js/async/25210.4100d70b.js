"use strict";(globalThis.webpackChunkfrontend=globalThis.webpackChunkfrontend||[]).push([["25210"],{12951:function(e,t,n){n.d(t,{A:()=>a});var i=n(74848),l=n(51851),s=n(7064),r=n(96540);let a=e=>((0,r.useEffect)(()=>{e.loadContentDispatch?.()},[]),(0,i.jsx)("div",{className:"ContentDisplay row center-xs",children:(0,i.jsx)("div",{className:`${e.fullWidth?"col-md-12":"col-md-10 col-xs-11"} contentdisplay-content-parent`,children:(0,i.jsx)(l.Z,{className:"contentdisplay-content",elevation:s.e.THREE,children:e.display})})}))},14017:function(e,t,n){n.r(t),n.d(t,{default:()=>I,Component:()=>W});var i=n(74848),l=n(64907),s=n(79642),r=n(58270),a=n(66314),o=n(96540),d=n(81333),c=n(83509),h=n(94894),p=n(81720),m=n(12951),u=n(51566),x=n(51062),y=n(69096),f=n(64088),g=n(60921),j=n(71609),P=n(28761),C=n(97426),A=n(22083);let v={cellClass:({data:e})=>e?.isPinned?"highlight-row-mGfcSA":""},O=({headers:e,stories:t,storyActions:n})=>{let l=(0,o.useMemo)(()=>[{flex:2,field:"authorName",headerName:"Author"},{flex:4,field:"title",headerName:"Title",cellRenderer:({data:e,value:t})=>e&&(0,i.jsxs)(u.A,{alignItems:"center",style:{columnGap:8},children:[e.isPinned&&(0,i.jsx)(P.I,{intent:"primary",icon:a.W.PIN}),t]})},{flex:6,field:"content",headerName:"Content",valueFormatter:({value:e})=>e.replaceAll(/\s+/g," ").length<=35?e.replaceAll(/\s+/g," "):e.split(/\s+/).reduce((e,t)=>e.length+t.length<=35?e+" "+t:e,"")+"â€¦",cellStyle:{textAlign:"left"}},{flex:3,field:"actions",headerName:"Actions",sortable:!1,cellRenderer:({data:e})=>n(e)}],[n]);return(0,i.jsx)("div",{style:{marginTop:24},children:(0,i.jsx)(A.W6,{theme:C.zl0,rowData:t,columnDefs:l,defaultColDef:v,domLayout:"autoHeight",suppressMovableColumns:!0,suppressCellFocus:!0})})};var k=n(92473),w=n(54348);let N=({storyId:e,handleDeleteStory:t,canView:n=!1,canEdit:l=!1,canDelete:r=!1,canPin:o=!1,isPinned:d=!1,handleTogglePin:c=()=>{},handleMovePinUp:p=()=>{},handleMovePinDown:m=()=>{}})=>{let x=(0,h.Zp)();return(0,i.jsxs)(u.A,{style:{height:"100%"},children:[n&&(0,i.jsx)(k.m,{targetProps:{style:{display:"flex"}},placement:w.yX.TOP,content:"View",children:(0,i.jsx)(s.$,{intent:"success",icon:a.W.EyeOpen,minimal:!0,onClick:()=>x(`./view/${e}`)})}),l&&(0,i.jsx)(k.m,{targetProps:{style:{display:"flex"}},placement:w.yX.TOP,content:"Edit",children:(0,i.jsx)(s.$,{intent:"primary",icon:a.W.EDIT,minimal:!0,onClick:()=>x(`./edit/${e}`)})}),o&&d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(k.m,{targetProps:{style:{display:"flex"}},placement:w.yX.TOP,content:"Reorder up",children:(0,i.jsx)(s.$,{icon:a.W.ARROW_UP,minimal:!0,onClick:()=>p(e)})}),(0,i.jsx)(k.m,{targetProps:{style:{display:"flex"}},placement:w.yX.TOP,content:"Reorder down",children:(0,i.jsx)(s.$,{icon:a.W.ARROW_DOWN,minimal:!0,onClick:()=>m(e)})})]}),o&&(0,i.jsx)(k.m,{targetProps:{style:{display:"flex"}},placement:w.yX.TOP,content:d?"Unpin":"Pin",children:(0,i.jsx)(s.$,{intent:"warning",icon:d?a.W.EXCLUDE_ROW:a.W.PIN,minimal:!0,onClick:()=>c(e)})}),r&&(0,i.jsx)(k.m,{targetProps:{style:{display:"flex"}},placement:w.yX.TOP,content:"Delete",children:(0,i.jsx)(s.$,{intent:"danger",icon:a.W.TRASH,minimal:!0,onClick:()=>t(e)})})]})},S=[{id:"author",header:"Author"},{id:"title",header:"Title"},{id:"content",header:"Content"},{id:"actions",header:"Actions"}],b=()=>{let{t:e}=(0,d.Bd)("translation",{keyPrefix:"stories"}),[t,n]=(0,o.useState)(""),P=(0,h.Zp)(),C=(0,c.wA)(),{userId:A,role:v}=(0,f.N4)(e=>e.stories),k=(0,f.N4)(e=>!e.stories.groupId),w=(0,o.useCallback)(()=>P("./new"),[P]),b=(0,o.useCallback)(async t=>{await (0,y.cu)({contents:(0,i.jsx)("p",{children:e("deleteConfirmation")}),positiveIntent:"danger",positiveLabel:e("delete")})&&C(g.A.deleteStory(t))},[C,e]),W=(0,f.N4)(e=>e.stories.storyList),I=(0,o.useCallback)(e=>{let t=W.find(t=>t.id===e),n=W.filter(e=>e.isPinned).length,i={...t,isPinned:!t.isPinned,pinOrder:t.isPinned?null:n};C(g.A.saveStory(i,e))},[C,W]),T=(0,o.useCallback)(e=>{let t=W.findIndex(t=>t.id===e);if(0===t)return;let n=W[t],i=W[t-1];[{...n,pinOrder:t-1},{...i,pinOrder:t}].forEach(e=>C(g.A.saveStory(e,e.id)))},[C,W]),D=(0,o.useCallback)(e=>{let t=W.findIndex(t=>t.id===e);if(t===W.filter(e=>e.isPinned).length-1)return;let n=W[t],i=W[t+1];[{...n,pinOrder:t+1},{...i,pinOrder:t}].forEach(e=>C(g.A.saveStory(e,e.id)))},[C,W]);return k?(0,i.jsx)(m.A,{display:(0,i.jsx)(l.I,{icon:a.W.ERROR,title:"Disabled",description:"Stories has been disabled for this course."})}):(0,i.jsx)(m.A,{loadContentDispatch:()=>C(g.A.getStoriesList()),display:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(u.A,{justifyContent:"space-between",children:[(0,i.jsxs)(u.A,{justifyContent:"flex-start",alignItems:"center",style:{columnGap:16},children:[(0,i.jsx)(x.A,{style:{fontSize:"1.125rem",opacity:.9},children:e("allStories")}),!!A&&(0,i.jsx)(s.$,{onClick:w,icon:a.W.PLUS,children:"Add Story"})]}),(0,i.jsx)(r.M,{className:"grading-search-input",placeholder:"Search for author...",leftIcon:"search",large:!0,value:t,onChange:e=>n(e.target.value)})]}),(0,i.jsx)(O,{headers:S,stories:W.map(e=>({...e,content:(0,j.to)(e.content).content})).filter(e=>e.isPinned||e.authorName.toLowerCase().includes(t.toLowerCase())),storyActions:e=>{let t=A===e.authorId,n=v===p.gO.Moderator||v===p.gO.Admin;return(0,i.jsx)(N,{storyId:e.id,handleDeleteStory:b,handleTogglePin:I,handleMovePinUp:T,handleMovePinDown:D,canView:!0,canEdit:t||n,canDelete:t||n,canPin:n,isPinned:e.isPinned})}})]})})},W=b;W.displayName="Stories";let I=b}}]);
//# sourceMappingURL=25210.4100d70b.js.map